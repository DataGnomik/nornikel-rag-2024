# Мультимодальная система RAG с использованием ColPali и Byaldi

Этот репозиторий содержит два основных компонента, реализующих мультимодальную систему на базе **Retrieval-Augmented Generation (RAG)**. Система работает с векторными базами данных и интегрирует текст и изображения для генерации ответов. В частности, используется фреймворк **Byaldi**, а модель **ColPali** предназначена для обработки мультимодальных запросов (текст и изображения).

## Часть 1: Создание векторной базы с использованием Byaldi для ColPali

В первой части проекта создаётся векторная база данных, которая используется для поиска и извлечения информации. Для этого используется фреймворк **Byaldi**, который позволяет:

- Генерировать и хранить векторные представления текста и изображений.
- Построить индекс для быстрого поиска по векторной базе.
- Работать с мультимодальными запросами и поддерживать взаимодействие между текстом и изображениями.

Эта часть проекта ориентирована на подготовку и настройку векторной базы, которая будет использоваться для дальнейшего инференса и работы модели.

### Основные шаги:

1. **Сбор данных**: Для создания векторной базы собираются текстовые и визуальные данные.
2. **Создание векторов**: С помощью фреймворка Byaldi генерируются векторные представления данных.
3. **Индексация и сохранение базы**: Все данные индексируются и сохраняются для дальнейшего использования.

## Часть 2: Использование готовой векторной базы и демонстрация работы модели

После того как векторная база была создана, вторая часть проекта демонстрирует, как использовать эту базу для инференса. Система подгружает готовую векторную базу и модель **ColPali** для выполнения мультимодальных задач, таких как:

- Обработка текстовых запросов и их соединение с изображениями для получения ответа.
- Отображение результатов работы модели (например, визуализация изображений и текста) внутри Jupyter Notebook (.ipynb).

### Основные шаги:

1. **Загрузка векторной базы и модели**: Загружаются заранее подготовленные векторные базы и модель ColPali.
2. **Обработка запросов**: Модель принимает текстовые запросы и использует векторную базу для поиска релевантных данных.
3. **Генерация ответа**: На основе полученных данных модель генерирует ответ с учётом как текста, так и изображений.
4. **Визуализация результатов**: Результаты работы модели наглядно отображаются в Jupyter Notebook, включая изображение и текст.

## Требования

Для работы с проектом вам потребуется установить следующие зависимости:

- Python 3.x
- PyTorch
- Hugging Face Transformers
- Byaldi (для работы с векторными базами)
- Pillow (для обработки изображений)
- NumPy, Pandas (для обработки данных)
- Jupyter Notebook (для демонстрации работы модели)
- другие зависимости, указанные в `requirements.txt`

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/your-repository-name.git
   cd your-repository-name
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Пример использования

### Часть 1: Создание векторной базы

1. Подготовьте исходные данные (текстовые и визуальные).
2. Запустите скрипт для создания векторной базы:
   ```bash
   python create_vector_database.py
   ```

### Часть 2: Демонстрация работы модели

1. Откройте Jupyter Notebook:
   ```bash
   jupyter notebook
   ```
2. Запустите блоки ноутбука, чтобы подгрузить модель и векторную базу и протестировать работу системы с реальными запросами.

## Примечания

- Данный проект использует модель **ColPali**, которая специально разработана для обработки мультимодальных запросов, где важна как текстовая информация, так и визуальная.
- Для работы с большими векторными базами и изображениями могут потребоваться ресурсы с достаточной мощностью (например, GPU).
- Убедитесь, что у вас есть доступ к необходимым данным для создания векторной базы и использования модели.


### Ключевые моменты:

1. **Описание частей проекта**:
   - Первая часть касается создания векторной базы с использованием фреймворка **Byaldi**.
   - Вторая часть связана с загрузкой базы, инференсом и демонстрацией работы модели **ColPali**.
   
2. **Требования и установка**:
   - Указаны основные зависимости для работы с проектом.
   - Даны инструкции по установке и запуску.

3. **Пример использования**:
   - Пояснение, как создавать векторные базы и запускать демонстрацию работы модели в Jupyter Notebook.

4. **Примечания**:
   - Уведомление о возможных требованиях к ресурсам и необходимости подготовки данных.
